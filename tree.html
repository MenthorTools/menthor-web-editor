
</template>
	<select id="tree-view-button" data-width='140px' class="selectpicker">
		<option data-icon="glyphicon glyphicon-eye-open" value="package-hierarchy"> Package</option>
		<option data-icon="glyphicon glyphicon-eye-open" value="type-hierarchy"> Hierarchy</option>
		<option data-icon="glyphicon glyphicon-eye-open" value="type-composition"> Composition</option>
	</select>
</template>

<script>
	/** install tree-view button */
	var thisDoc = document._currentScript.ownerDocument;
	var thatDoc = document;
    var content = thisDoc.querySelector('#tree-view-button');	 
	var cloned = thatDoc.importNode(content, true);
	thatDoc.querySelector('#menubar-container').appendChild(cloned);
</script>

<!-- Behaviour -->

<script>

/** install tree view listener */
$(function() {
	$('#tree-view-button').on('change', function(){
		var selected = $(this).find("option:selected").val();		
		loadJSTreeFromUrl(ADDR+"api/tree/"+selected)		
	});  
});

/** install node double-click listener */
$('#jstree').bind("dblclick.jstree", function (event){
   var node = $(event.target).closest("li");
   var data = node.data("jstree");
   alert(node.attr('id'));
});

/** load tree content from the server via ajax */
function loadJSTree(){
	var selected = $('#tree-view-button').find("option:selected").val();		
	var url = ADDR+"api/tree/"+selected;
	loadJSTreeFromUrl(url);
}

/** load tree content from the server via ajax */
function loadJSTreeFromUrl(url){	
	$('#jstree').jstree("destroy");
    $('#jstree').jstree({
		'core' : { 
		  "multiple" : false,
		  'data' : {			
			"url" : url,
			"dataType" : "json",
		  }
		},
		"types": typeTreeConfig(),
		"plugins" : [ "types" ]
	})
}

/** setup jstree icons */
function typeTreeConfig(){
	return {
		"default" : {"icon" : ""},
		"class" : {"icon" : "/icon/type.png" },
		"package" : {"icon" : "/icon/package.png" },
		"datatype" : {"icon" : "/icon/type.png" },
		"type" : {"icon" : "/icon/type.png" },
		"meronymic" : {"icon" : "/icon/componentof.png" },
		"generalization" : {"icon" : "/icon/generalization.png" },
	}
}
</script>